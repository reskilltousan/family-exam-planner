# 要件定義書

## 機能概要
受験期の家庭向けに、子どものイベント（学校・塾・模試・本番試験等）と準備タスクを一元管理し、Googleカレンダー予定も重ねて家族ビューで確認できるWebアプリのMVPを定義する。

## ユーザーストーリー
- 保護者として、受験関連の予定と準備タスクを家族で一元管理したい。なぜなら情報が紙・ポータル・カレンダーに散在し漏れや二重予約を防ぎたいから。
- 保護者として、仕事予定（Googleカレンダー）と子どものmustイベントのバッティングを早めに把握したい。なぜなら送迎や付き添いの調整を事前に行う必要があるから。
- 子どもとして、今週の自分の予定とやることを1画面で確認したい。なぜなら何をいつまでに終わらせればよいか自分で把握したいから。

## 機能要件
### 要件1: 家族・メンバー管理
- 家族アカウントを作成し、メンバーをロール（parent/child）付きで登録できる。子どもごとに名前・学年など基本情報を保持する。
- 受入基準：
  - [ ] 家族アカウントが作成できること。
  - [ ] 子どもを1人以上登録・一覧表示できること。
  - [ ] メンバーのロールがparent/childで保存・参照できること。

### 要件2: イベント管理とカレンダー表示
- イベントのCRUDを提供し、タイトル/日付/開始・終了時刻/種別(school, cram, lesson, exam, other)/重要度(must, should, optional)/参加者/場所/メモを保持する。家族全体の週・月ビューを表示し、子ども・種別でフィルタできる。
- 受入基準：
  - [ ] イベントを作成・編集・削除・一覧表示できること。
  - [ ] 週表示・月表示が切り替えられること。
  - [ ] 子ども別および種別フィルタで表示を絞り込めること。

### 要件3: 準備タスク管理（イベント紐づけ）
- 各イベントに準備タスクを紐づけ、タイトル/期限/ステータス(not_started, in_progress, done)/担当者(parent/child)を管理する。タスクはユーザーが手動で追加する。
- 受入基準：
  - [ ] イベントに対して複数のタスクを追加・編集・削除できること。
  - [ ] ステータスが3段階で更新できること。
  - [ ] 担当者をfamilyメンバーから選択して保存できること。

### 要件4: 子ども別「今週の予定・タスク」ビュー
- 特定の子どもに紐づくイベントとタスクを「今週」範囲でまとめて表示するビューを提供する。
- 受入基準：
  - [ ] 子どもを指定すると、その子の今週のイベント一覧が表示されること。
  - [ ] 同じ画面でその子のタスクをステータス別に表示できること。

### 要件5: Googleカレンダー読み取り・重ね合わせ
- 家族1つのGoogleアカウントを接続し、指定期間の予定を読み取り、家族カレンダーに外部イベントとして重ねて表示する（読み取り専用）。
- 受入基準：
  - [ ] OAuth連携によりGoogle予定を取得できること（作成・更新は行わない）。
  - [ ] 外部イベントがアプリ内イベントと区別できる表示になること。
  - [ ] 接続解除または再取得が行えること。

### 要件6: コンフリクト検知（mustイベントの時間重複）
- 重要度mustのイベント同士が同一子ども（必要なら保護者）で時間重複する場合に検知し、カレンダー上で警告表示する。
- 受入基準：
  - [ ] 同一時間帯で重複するmustイベントを検知できること。
  - [ ] 重複イベントが警告表示（例: 赤枠/アイコン）されること。

### 要件7: イベントメモ・ジャーナル
- 各イベントにテキストメモを複数追加できる。プレーンテキストのみ、画像やリッチテキストは対象外。
- 受入基準：
  - [ ] メモを追加・編集・削除できること。
  - [ ] メモがイベントに紐づいて表示されること。

## 非機能要件
- パフォーマンス：主要画面（週/月カレンダー、子ども別ビュー）の初回表示が3秒以内で完了すること（ローカル/デモ環境目安）。
- セキュリティ：
  - OAuthトークンや認証情報は安全なストア（DBやKey Vault想定）に保存し、平文でクライアントに露出しないこと。
  - 家族アカウント間のデータ分離を行い、他家族のデータが参照できないこと。
